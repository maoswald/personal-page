var STORAGE_KEY,enableScripts,isDntEnabled,initConsent,PREFETCH_ATTR,initPrefetch,initSearch,haversineDistance,renderList,renderNearby,initTravelMap,attachCopyButtons=()=>{document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentElement;if(n.querySelector("button.copy-button"))return;const t=document.createElement("button");t.type="button",t.className="copy-button",t.setAttribute("aria-label","Copy code"),t.textContent="Copy",t.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(e.innerText),t.textContent="Copied!",setTimeout(()=>{t.textContent="Copy"},1500)}catch{t.textContent="Error"}}),n.appendChild(t)})};typeof window!="undefined"&&(document.readyState!=="loading"?attachCopyButtons():document.addEventListener("DOMContentLoaded",attachCopyButtons)),STORAGE_KEY="aurora-consent",enableScripts=()=>{document.querySelectorAll("script[data-analytics-script]").forEach(e=>{if(e.dataset.loaded==="true")return;const t=document.createElement("script");[...e.attributes].forEach(e=>{if(e.name==="type"||e.name==="data-analytics-script")return;t.setAttribute(e.name,e.value)}),t.textContent=e.textContent,e.replaceWith(t)})},isDntEnabled=()=>{const e=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;return e==="1"||e==="yes"},initConsent=()=>{const e=document.querySelector("[data-cookie-consent]");if(!e)return;const s=localStorage.getItem(STORAGE_KEY),o=isDntEnabled();if(o){e.setAttribute("hidden","true"),e.setAttribute("data-dnt","true");return}if(s==="accepted"){e.setAttribute("hidden","true"),enableScripts();return}const t=e.querySelector("[data-consent-accept]"),n=e.querySelector("[data-consent-decline]");t?.addEventListener("click",()=>{localStorage.setItem(STORAGE_KEY,"accepted"),enableScripts(),e.setAttribute("hidden","true")}),n?.addEventListener("click",()=>{localStorage.setItem(STORAGE_KEY,"declined"),e.setAttribute("hidden","true")})},typeof window!="undefined"&&(document.readyState!=="loading"?initConsent():document.addEventListener("DOMContentLoaded",initConsent)),PREFETCH_ATTR="data-prefetch",initPrefetch=()=>{if(!("IntersectionObserver"in window))return;const e=document.querySelectorAll(`a[${PREFETCH_ATTR}]`);if(!e.length)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;t.unobserve(n);const s=n.href;fetch(s,{method:"GET",mode:"no-cors"}).catch(()=>{})}})});e.forEach(e=>t.observe(e))},typeof window!="undefined"&&(document.readyState!=="loading"?initPrefetch():document.addEventListener("DOMContentLoaded",initPrefetch)),initSearch=()=>{const e=document.querySelector("[data-search-root]");if(!e||typeof window=="undefined")return;if(typeof window.elasticlunr=="undefined")return;const a=e.querySelector('input[type="search"]'),t=e.querySelector("[data-search-results]"),n=e.querySelector("[data-search-summary]"),r=e.dataset.indexUrl;let s,o={};const i=s=>{if(t.innerHTML="",!s.length){t.innerHTML=`<p class="notice">${e.dataset.noResults}</p>`,n.textContent=e.dataset.summaryTemplate.replace("{count}","0");return}n.textContent=e.dataset.summaryTemplate.replace("{count}",String(s.length));const i=document.createDocumentFragment();s.forEach(e=>{const t=o[e.ref]||e.doc,n=document.createElement("article");n.className="search-result",n.innerHTML=`
        <h3><a href="${t.permalink}" data-prefetch>${t.title}</a></h3>
        <p>${t.summary}</p>
        <p class="timeline-meta">${t.section}</p>
        <div class="tech-badges">${t.tags.map(e=>`<span class="tag-chip">${e}</span>`).join("")}</div>
      `,i.appendChild(n)}),t.appendChild(i)},c=e=>{s=window.elasticlunr(function(){this.addField("title"),this.addField("summary"),this.addField("tags"),this.addField("section"),this.setRef("permalink")}),e.forEach(e=>{o[e.permalink]=e,s.addDoc(e)})};fetch(r).then(e=>e.json()).then(e=>{c(e),i(e.map(e=>({ref:e.permalink,doc:e})))}).catch(()=>{n.textContent=e.dataset.errorLabel}),a.addEventListener("input",e=>{const t=e.target.value.trim();if(!t){i(Object.values(o).map(e=>({ref:e.permalink,doc:e})));return}const n=s.search(t,{fields:{title:{boost:3},summary:{boost:2},tags:{boost:1}},expand:!0});i(n)})},typeof window!="undefined"&&(document.readyState!=="loading"?initSearch():document.addEventListener("DOMContentLoaded",initSearch)),haversineDistance=(e,t)=>{const n=e=>e*Math.PI/180,a=6371,r=n(t.lat-e.lat),c=n(t.lng-e.lng),l=n(e.lat),d=n(t.lat),s=Math.sin(r/2),o=Math.sin(c/2),i=s*s+o*o*Math.cos(l)*Math.cos(d),u=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));return a*u},renderList=(e,t)=>{if(!t)return;t.innerHTML="";const n=document.createDocumentFragment();e.forEach(e=>{const t=document.createElement("article");t.className="card",t.innerHTML=`
      <h3><a href="${e.permalink}">${e.title}</a></h3>
      <p>${e.summary}</p>
      <p class="timeline-meta">${e.city}, ${e.country}</p>
      <div class="tech-badges">${(e.tags||[]).map(e=>`<span class="tag-chip">${e}</span>`).join("")}</div>
    `,n.appendChild(t)}),t.appendChild(n)},renderNearby=e=>{var n;const t=document.querySelector("[data-nearby-list]");if(!t||!e?.active||!((n=e?.nearby)==null?0[0]:n.length))return;const s=e.active.gps,o=e.nearby.map(e=>({...e,distance:haversineDistance(s,e.gps)})).filter(e=>e.distance>.5).sort((e,t)=>e.distance-t.distance).slice(0,4);t.innerHTML="",o.forEach(e=>{const n=document.createElement("li");n.innerHTML=`<a href="${e.permalink}">${e.title}</a> \xB7 ${e.distance.toFixed(1)} km`,t.appendChild(n)})},initTravelMap=()=>{const c=document.getElementById("travel-map");if(!c||typeof window=="undefined")return;const{L:e}=window;if(!e)return;const t=JSON.parse(c.dataset.config||"{}"),s=t.points||[],p=t.tiles,f=t.attribution,h=t.center||[0,0],u=t.zoom||2,r=e.markerClusterGroup?e.markerClusterGroup():e.layerGroup(),n=e.map(c,{scrollWheelZoom:!0}).setView(h,u);e.tileLayer(p,{attribution:f,maxZoom:19}).addTo(n);const a=document.querySelector('[data-map-filter="country"]'),i=document.querySelector('[data-map-filter="search"]'),o=document.querySelector('[data-map-filter="tags"]'),g=document.querySelector("[data-travel-list]"),l=t=>{if(r.clearLayers(),t.forEach(t=>{if(!t.gps)return;const n=e.marker([t.gps.lat,t.gps.lng]);n.bindPopup(`
        <div class="map-popup">
          <h3>${t.title}</h3>
          <p>${t.summary}</p>
          <p class="timeline-meta">${t.city}, ${t.country}</p>
          <a class="button button-ghost" href="${t.permalink}">Read article</a>
        </div>
      `),r.addLayer(n)}),r.addTo(n),t.length>1){const e=t.filter(e=>e.gps).map(e=>[e.gps.lat,e.gps.lng]);e.length&&n.fitBounds(e,{padding:[40,40]})}else t.length===1&&t[0].gps?n.setView([t[0].gps.lat,t[0].gps.lng],t[0].map_zoom||8):n.setView(h,u);renderList(t,g)};if(t.mode==="detail"){l(s),renderNearby(t);return}const d=()=>{const t=i?.value.toLowerCase()||"",n=a?.value||"all",r=Array.from(o?.querySelectorAll('input[type="checkbox"]:checked')||[]).map(e=>e.value);let e=s;n!=="all"&&(e=e.filter(e=>e.country===n)),t&&(e=e.filter(e=>`${e.title} ${e.summary} ${(e.tags||[]).join(" ")}`.toLowerCase().includes(t))),r.length&&(e=e.filter(e=>r.every(t=>(e.tags||[]).includes(t)))),l(e)};a&&a.addEventListener("change",d),i&&i.addEventListener("input",d),o?.addEventListener("change",d);const v=new URLSearchParams(window.location.search),m=v.get("near");if(m){const[e,t]=m.split(",").map(Number);!Number.isNaN(e)&&!Number.isNaN(t)&&s.sort((n,s)=>haversineDistance({lat:e,lng:t},n.gps)-haversineDistance({lat:e,lng:t},s.gps))}l(s)},typeof window!="undefined"&&(document.readyState!=="loading"?initTravelMap():document.addEventListener("DOMContentLoaded",initTravelMap))